#!/usr/bin/env bash
set -Eeuo pipefail

LIB="$HOME/.config/theme-system/lib"
source "$LIB/core.sh"
source "$LIB/theme.sh"
source "$LIB/waybar.sh"

theme="$(get_theme)"
theme_dir="$THEME_ROOT/$theme"

# GTK
safe_link \
"$theme_dir/gtk-3.0/gtk-$theme.css" \
"$HOME/.config/gtk-3.0/gtk.css"

safe_link \
"$theme_dir/gtk-4.0/gtk-$theme.css" \
"$HOME/.config/gtk-4.0/gtk.css"

# swaync
safe_link \
"$theme_dir/swaync/style-$theme.css" \
"$HOME/.config/swaync/style.css"

# hyprlock
safe_link \
"$theme_dir/hypr/hyprlock-$theme.conf" \
"$HOME/.config/hypr/hyprlock.conf"

# fuzzel
safe_link \
"$theme_dir/fuzzel/fuzzel-$theme.ini" \
"$HOME/.config/fuzzel/fuzzel.ini"

apply_waybar

systemctl --user reload-or-restart swaync.service 2>/dev/null || true

notify "Theme applied â†’ $theme"
